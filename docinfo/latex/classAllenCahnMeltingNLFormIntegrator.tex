\hypertarget{classAllenCahnMeltingNLFormIntegrator}{}\section{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$ S\+C\+H\+E\+ME, E\+N\+E\+R\+GY, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, M\+O\+BI $>$ Class Template Reference}
\label{classAllenCahnMeltingNLFormIntegrator}\index{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$ S\+C\+H\+E\+M\+E, E\+N\+E\+R\+G\+Y, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+O\+N, M\+O\+B\+I $>$@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$ S\+C\+H\+E\+M\+E, E\+N\+E\+R\+G\+Y, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+O\+N, M\+O\+B\+I $>$}}


Inheritance diagram for Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$ S\+C\+H\+E\+ME, E\+N\+E\+R\+GY, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, M\+O\+BI $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classAllenCahnMeltingNLFormIntegrator__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$ S\+C\+H\+E\+ME, E\+N\+E\+R\+GY, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, M\+O\+BI $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classAllenCahnMeltingNLFormIntegrator__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classAllenCahnMeltingNLFormIntegrator_a56ffb7b7b6963cf1cf8060e82361d861}{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator} (const mfem\+::\+Grid\+Function \&\+\_\+u\+\_\+old, const double \&\+\_\+omega, const double \&\+\_\+lambda, const double \&\+\_\+mob, \hyperlink{classPhaseChangeCoefficient}{Phase\+Change\+Coefficient} \+\_\+alpha)
\begin{DoxyCompactList}\small\item\em Construct. \end{DoxyCompactList}\item 
virtual void \hyperlink{classAllenCahnMeltingNLFormIntegrator_ab8e7696b5052bda3c43f95f67f0b798f}{Assemble\+Element\+Vector} (const mfem\+::\+Finite\+Element \&el, mfem\+::\+Element\+Transformation \&Tr, const mfem\+::\+Vector \&elfun, mfem\+::\+Vector \&elvect)
\begin{DoxyCompactList}\small\item\em Residual part of the non linear problem. \end{DoxyCompactList}\item 
virtual void \hyperlink{classAllenCahnMeltingNLFormIntegrator_a017da5aa8e63fb3d5c4ec65e721c957e}{Assemble\+Element\+Grad} (const mfem\+::\+Finite\+Element \&el, mfem\+::\+Element\+Transformation \&Tr, const mfem\+::\+Vector \&elfun, mfem\+::\+Dense\+Matrix \&elmat)
\begin{DoxyCompactList}\small\item\em Jacobian part of the non linear problem. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$Thermodynamics\+Potential\+Discretization S\+C\+H\+E\+ME, Thermodynamics\+Potentials E\+N\+E\+R\+GY, Thermodynamics\+Potentials I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, Mobility M\+O\+BI$>$\newline
class Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$ S\+C\+H\+E\+M\+E, E\+N\+E\+R\+G\+Y, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+O\+N, M\+O\+B\+I $>$}



Definition at line 19 of file Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classAllenCahnMeltingNLFormIntegrator_a56ffb7b7b6963cf1cf8060e82361d861}\label{classAllenCahnMeltingNLFormIntegrator_a56ffb7b7b6963cf1cf8060e82361d861}} 
\index{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}!Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}}
\index{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}!Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}}
\subsubsection{\texorpdfstring{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator()}{AllenCahnMeltingNLFormIntegrator()}}
{\footnotesize\ttfamily template$<$Thermodynamics\+Potential\+Discretization S\+C\+H\+E\+ME, Thermodynamics\+Potentials E\+N\+E\+R\+GY, Thermodynamics\+Potentials I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, Mobility M\+O\+BI$>$ \\
\hyperlink{classAllenCahnMeltingNLFormIntegrator}{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}$<$ S\+C\+H\+E\+ME, E\+N\+E\+R\+GY, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, M\+O\+BI $>$\+::\hyperlink{classAllenCahnMeltingNLFormIntegrator}{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator} (\begin{DoxyParamCaption}\item[{const mfem\+::\+Grid\+Function \&}]{\+\_\+u\+\_\+old,  }\item[{const double \&}]{\+\_\+omega,  }\item[{const double \&}]{\+\_\+lambda,  }\item[{const double \&}]{\+\_\+mob,  }\item[{\hyperlink{classPhaseChangeCoefficient}{Phase\+Change\+Coefficient}}]{\+\_\+alpha }\end{DoxyParamCaption})}



Construct. 


\begin{DoxyTemplParams}{Template Parameters}
{\em S\+C\+H\+E\+ME} & \\
\hline
{\em E\+N\+E\+R\+GY} & \\
\hline
{\em I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em \+\_\+u\+\_\+old} & \\
\hline
{\em \+\_\+omega} & \\
\hline
{\em \+\_\+lambda} & \\
\hline
{\em \+\_\+alpha} & \\
\hline
{\em \+\_\+mob} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator$<$\+S\+C\+H\+E\+M\+E, E\+N\+E\+R\+G\+Y, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+O\+N$>$\+:\+: 
\end{DoxyReturn}


Definition at line 71 of file Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator.\+hpp.


\begin{DoxyCode}
74     : u\_old(\_u\_old), omega(\_omega), lambda(\_lambda), mob\_(\_mob), alpha\_(\_alpha) \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classAllenCahnMeltingNLFormIntegrator_a017da5aa8e63fb3d5c4ec65e721c957e}\label{classAllenCahnMeltingNLFormIntegrator_a017da5aa8e63fb3d5c4ec65e721c957e}} 
\index{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}!Assemble\+Element\+Grad@{Assemble\+Element\+Grad}}
\index{Assemble\+Element\+Grad@{Assemble\+Element\+Grad}!Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}}
\subsubsection{\texorpdfstring{Assemble\+Element\+Grad()}{AssembleElementGrad()}}
{\footnotesize\ttfamily template$<$Thermodynamics\+Potential\+Discretization S\+C\+H\+E\+ME, Thermodynamics\+Potentials E\+N\+E\+R\+GY, Thermodynamics\+Potentials I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, Mobility M\+O\+BI$>$ \\
void \hyperlink{classAllenCahnMeltingNLFormIntegrator}{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}$<$ S\+C\+H\+E\+ME, E\+N\+E\+R\+GY, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, M\+O\+BI $>$\+::Assemble\+Element\+Grad (\begin{DoxyParamCaption}\item[{const mfem\+::\+Finite\+Element \&}]{el,  }\item[{mfem\+::\+Element\+Transformation \&}]{Tr,  }\item[{const mfem\+::\+Vector \&}]{elfun,  }\item[{mfem\+::\+Dense\+Matrix \&}]{elmat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Jacobian part of the non linear problem. 


\begin{DoxyTemplParams}{Template Parameters}
{\em S\+C\+H\+E\+ME} & \\
\hline
{\em E\+N\+E\+R\+GY} & \\
\hline
{\em I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em el} & \\
\hline
{\em Tr} & \\
\hline
{\em elfun} & \\
\hline
{\em elmat} & \\
\hline
\end{DoxyParams}


Definition at line 161 of file Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator.\+hpp.


\begin{DoxyCode}
163                             \{
164   \textcolor{keywordtype}{int} nd = el.GetDof();
165   \textcolor{keywordtype}{int} dim = el.GetDim();
166   \textcolor{keywordtype}{int} spaceDim = Tr.GetSpaceDim();
167   \textcolor{keywordtype}{bool} square = (dim == spaceDim);
168   \textcolor{keywordtype}{double} w;
169 
170   shape.SetSize(nd);
171   dshape.SetSize(nd, dim);
172   dshapedxt.SetSize(nd, spaceDim);
173   elmat.SetSize(nd);
174 
175   \textcolor{keyword}{const} mfem::IntegrationRule* ir =
176       &mfem::IntRules.Get(el.GetGeomType(), 2 * el.GetOrder() + Tr.OrderW());
177 
178   elmat = 0.0;
179   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < ir->GetNPoints(); i++) \{
180     \textcolor{keyword}{const} mfem::IntegrationPoint& ip = ir->IntPoint(i);
181     el.CalcDShape(ip, dshape);  \textcolor{comment}{// dphi}
182     \textcolor{keyword}{const} \textcolor{keyword}{auto} u = elfun * shape;
183     \textcolor{keyword}{const} \textcolor{keyword}{auto} un = u\_old.GetValue(Tr, ip);
184 
185     \textcolor{keyword}{const} \textcolor{keyword}{auto} W = this->energy\_second\_derivative\_potential\_.
      \hyperlink{classPotentialFunctions_af7b46074a256a70b110ae621d0335874}{getPotentialFunction}(un);
186     \textcolor{keyword}{const} \textcolor{keyword}{auto} H = this->interpolation\_second\_derivative\_potential\_.
      \hyperlink{classPotentialFunctions_af7b46074a256a70b110ae621d0335874}{getPotentialFunction}(un);
187     \textcolor{keyword}{const} \textcolor{keyword}{auto} Wsecond = W(u);
188     \textcolor{keyword}{const} \textcolor{keyword}{auto} Hsecond = H(u);
189     \textcolor{keyword}{const} \textcolor{keyword}{auto} MOB = this->mobility\_function\_.getMobilityFunction(un);
190     \textcolor{keyword}{const} \textcolor{keyword}{auto} Mphi = MOB(this->mob\_);
191     \textcolor{keyword}{const} \textcolor{keyword}{auto} phase\_change = this->alpha\_.Eval(Tr, ip);
192 
193     Tr.SetIntPoint(&ip);
194     w = Tr.Weight();  \textcolor{comment}{// det(J)}
195     \textcolor{comment}{// std::cout << " SQUARE  ? " << square << std::endl;}
196     w = ip.weight / (square ? w : w * w * w);
197     \textcolor{comment}{// AdjugateJacobian = / adj(J),         if J is square}
198     \textcolor{comment}{//                    \(\backslash\) adj(J^t.J).J^t, otherwise}
199 
200     \textcolor{comment}{// Tr.AdjugateJacobian() det(J)J-1}
201 
202     \textcolor{comment}{// w = w* Mphi * lambda}
203     w *= Mphi * this->lambda;
204 
205     \textcolor{comment}{// dshapedxt =  det(J)J-1 dshape}
206     Mult(dshape, Tr.AdjugateJacobian(), dshapedxt);
207     \textcolor{comment}{// elmat += w * dshapedxt * dshapedxt^T}
208     AddMult\_a\_AAt(w, dshapedxt, elmat);
209 
210     \textcolor{comment}{//  (this->omega * secondDerivativedoubleWellPotential(elfun * shape) +}
211     \textcolor{comment}{//   this->alpha * secondDerivativeInterpolationPotential(elfun * shape)) *}
212     \textcolor{comment}{// Compute w'(u)*(du,v), v is shape function}
213     \textcolor{keywordtype}{double} fun\_val =
214         Mphi * (this->omega * Wsecond + phase\_change * Hsecond) * ip.weight * Tr.Weight();  \textcolor{comment}{// w'(u)}
215     \textcolor{comment}{// elmat += fun\_val * shape * shape^T}
216     AddMult\_a\_VVt(fun\_val, shape, elmat);  \textcolor{comment}{// w'(u)*(du, v)}
217   \}
218 \}
\end{DoxyCode}
\mbox{\Hypertarget{classAllenCahnMeltingNLFormIntegrator_ab8e7696b5052bda3c43f95f67f0b798f}\label{classAllenCahnMeltingNLFormIntegrator_ab8e7696b5052bda3c43f95f67f0b798f}} 
\index{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}!Assemble\+Element\+Vector@{Assemble\+Element\+Vector}}
\index{Assemble\+Element\+Vector@{Assemble\+Element\+Vector}!Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator@{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}}
\subsubsection{\texorpdfstring{Assemble\+Element\+Vector()}{AssembleElementVector()}}
{\footnotesize\ttfamily template$<$Thermodynamics\+Potential\+Discretization S\+C\+H\+E\+ME, Thermodynamics\+Potentials E\+N\+E\+R\+GY, Thermodynamics\+Potentials I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, Mobility M\+O\+BI$>$ \\
void \hyperlink{classAllenCahnMeltingNLFormIntegrator}{Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator}$<$ S\+C\+H\+E\+ME, E\+N\+E\+R\+GY, I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON, M\+O\+BI $>$\+::Assemble\+Element\+Vector (\begin{DoxyParamCaption}\item[{const mfem\+::\+Finite\+Element \&}]{el,  }\item[{mfem\+::\+Element\+Transformation \&}]{Tr,  }\item[{const mfem\+::\+Vector \&}]{elfun,  }\item[{mfem\+::\+Vector \&}]{elvect }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Residual part of the non linear problem. 


\begin{DoxyTemplParams}{Template Parameters}
{\em S\+C\+H\+E\+ME} & \\
\hline
{\em E\+N\+E\+R\+GY} & \\
\hline
{\em I\+N\+T\+E\+R\+P\+O\+L\+A\+T\+I\+ON} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em el} & \\
\hline
{\em Tr} & \\
\hline
{\em elfun} & \\
\hline
{\em elvect} & \\
\hline
\end{DoxyParams}


Definition at line 89 of file Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator.\+hpp.


\begin{DoxyCode}
91                         \{
92   \textcolor{keywordtype}{int} nd = el.GetDof();
93   \textcolor{keywordtype}{int} dim = el.GetDim();
94   \textcolor{keywordtype}{int} spaceDim = Tr.GetSpaceDim();
95   dshape.SetSize(nd, dim);
96   shape.SetSize(nd);
97   invdfdx.SetSize(dim, spaceDim);
98   vec.SetSize(dim);
99   pointflux.SetSize(spaceDim);
100 
101   elvect.SetSize(nd);
102   \textcolor{keyword}{const} mfem::IntegrationRule* ir =
103       &mfem::IntRules.Get(el.GetGeomType(), 2 * el.GetOrder() + Tr.OrderW());
104 
105   elvect = 0.0;
106   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < ir->GetNPoints(); i++) \{
107     \textcolor{keyword}{const} mfem::IntegrationPoint& ip = ir->IntPoint(i);
108     el.CalcDShape(ip, dshape);  \textcolor{comment}{// dphi}
109     el.CalcShape(ip, shape);    \textcolor{comment}{// phi}
110     Tr.SetIntPoint(&ip);
111 
112     \textcolor{keyword}{const} \textcolor{keyword}{auto} u = elfun * shape;
113     \textcolor{keyword}{const} \textcolor{keyword}{auto} un = u\_old.GetValue(Tr, ip);
114 
115     \textcolor{keyword}{const} \textcolor{keyword}{auto} W = this->energy\_first\_derivative\_potential\_.\hyperlink{classPotentialFunctions_af7b46074a256a70b110ae621d0335874}{getPotentialFunction}(un);
116     \textcolor{keyword}{const} \textcolor{keyword}{auto} H = this->interpolation\_first\_derivative\_potential\_.
      \hyperlink{classPotentialFunctions_af7b46074a256a70b110ae621d0335874}{getPotentialFunction}(un);
117     \textcolor{keyword}{const} \textcolor{keyword}{auto} Wprime = W(u);
118     \textcolor{keyword}{const} \textcolor{keyword}{auto} Hprime = H(u);
119     \textcolor{keyword}{const} \textcolor{keyword}{auto} MOB = this->mobility\_function\_.getMobilityFunction(un);
120     \textcolor{keyword}{const} \textcolor{keyword}{auto} Mphi = MOB(this->mob\_);
121     \textcolor{keyword}{const} \textcolor{keyword}{auto} phase\_change = this->alpha\_.Eval(Tr, ip);
122 
123     CalcAdjugate(Tr.Jacobian(), invdfdx);  \textcolor{comment}{// invdfdx = adj(J)}
124 
125     dshape.MultTranspose(elfun, vec);
126     invdfdx.MultTranspose(vec, pointflux);
127 
128     \textcolor{comment}{// Energy contribution}
129     \textcolor{keyword}{const} \textcolor{keyword}{auto} energy = this->omega * Wprime;
130     \textcolor{comment}{// Enthalpy of melting contribution}
131     \textcolor{keyword}{const} \textcolor{keyword}{auto} enthalpy = phase\_change * Hprime;
132     \textcolor{comment}{// flow of phase change + source term}
133     \textcolor{keyword}{const} \textcolor{keyword}{auto} fun\_val = Mphi * (energy + enthalpy);
134 
135     \textcolor{comment}{// Given phi, compute (w'(phi)-f, v), v is shape function}
136     \textcolor{keyword}{const} \textcolor{keywordtype}{double} ww = ip.weight * Tr.Weight() * fun\_val;
137     add(elvect, ww, shape, elvect);
138 
139     \textcolor{comment}{// Laplacian : given u, compute (grad(u), grad(v)), v is shape function.}
140     \textcolor{keywordtype}{double} w;
141     w = Mphi * ip.weight * this->lambda / Tr.Weight();
142     pointflux *= w;
143     invdfdx.Mult(pointflux, vec);
144     dshape.AddMult(vec, elvect);
145   \}
146 \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
Allen\+Cahn\+Melting\+N\+L\+Form\+Integrator.\+hpp\end{DoxyCompactItemize}
